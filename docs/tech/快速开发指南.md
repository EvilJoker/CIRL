# 快速开发指南

## 环境要求

- Node.js >= 20.0.0
- npm

## 安装依赖

```bash
# 根目录
npm install

# 前端
cd web
npm install
```

## 开发

### 启动前端开发服务器

```bash
npm run dev
```

前端运行在 `http://localhost:5173`

### 启动后端服务器

```bash
npm run dev:server
```

后端运行在 `http://localhost:3001`

## 项目结构

```
cirl/
├── bin/              # CLI 工具
├── server/           # Express 后端
│   ├── index.js               # 服务器入口
│   ├── dataManager.js         # JSON 读写
│   ├── similarityService.js   # 命中相似度计算
│   └── evaluationService.js   # 评估指标计算
├── web/              # Vue 3 前端
│   └── src/
│       ├── components/
│       ├── composables/
│       ├── lib/
│       └── types/
├── data/             # 数据文件
│   ├── apps.json
│   ├── query-records.json
│   ├── feedbacks.json
│   ├── datasets.json
│   ├── hit-analyses.json
│   ├── evaluations.json
│   └── optimization-suggestions.json
└── docs/             # 文档
```

## API 接口

完整的 API 文档请访问：**http://localhost:3001/api-docs**（Swagger UI）

### 主要 API 模块

- **应用管理**：`GET/POST/PUT/DELETE /api/apps`
- **问答记录**：`GET/POST/PUT /api/query-records`
- **反馈管理**：`GET/POST/PUT /api/feedbacks`，`POST /api/feedbacks/:id/analyze`
- **数据集管理**：`GET/POST/PUT/DELETE /api/datasets`
- **命中分析**：`POST /api/hit-analyses`，`GET /api/hit-analyses`，`GET /api/hit-analyses/stats`
- **效果评估**：`POST /api/evaluations`，`GET /api/evaluations`，`GET /api/evaluations/compare`
- **优化建议**：`GET/PUT /api/optimization-suggestions`

详细 API 文档请参考：
- 交互式文档：http://localhost:3001/api-docs
- 文本文档：`docs/tech/api-reference.md`

## 数据文件格式

所有数据文件位于 `data/` 目录，使用 JSON 格式存储。

### apps.json

```json
[
  {
    "id": "app_1234567890",
    "name": "Support Copilot",
    "description": "客服 FAQ 问答助手",
    "metadata": {},
    "createdAt": "2025-01-18T08:00:00.000Z",
    "updatedAt": "2025-01-18T08:00:00.000Z"
  }
]
```

### query-records.json

```json
[
  {
    "id": "qr_1234567890",
    "appId": "app_1234567890",
    "input": "如何重置密码？",
    "output": "请打开设置 > 安全 > 密码，按照向导完成重置。",
    "modelId": "gpt-4o-mini",
    "curated": false,
    "tags": ["账户", "安全"],
    "metadata": {
      "responseTime": 820
    },
    "createdAt": "2025-01-19T02:05:00.000Z",
    "updatedAt": "2025-01-19T02:05:00.000Z"
  }
]
```

完整的数据模型定义请参考：
- `docs/PROJECT_OVERVIEW.md` - 数据模型章节
- `web/src/types/index.ts` - TypeScript 类型定义

## 构建

```bash
npm run build
```

构建产物在 `dist/` 目录。

## 调试

### 前端调试

- 使用 Vue DevTools
- 浏览器控制台查看 API 请求

### 后端调试

- 查看服务器日志
- 检查 `data/` 目录下的 JSON 文件

